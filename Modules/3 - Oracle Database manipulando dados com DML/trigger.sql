DELETE FROM ITENS_NOTAS;
DELETE FROM NOTAS;

SELECT * FROM CLIENTES;
--1471156710

SELECT * FROM VENDEDORES;
--235
SELECT * FROM PRODUTOS;
--1040107

SELECT * FROM NOTAS;

INSERT INTO NOTAS (NUMERO, DATA_VENDA, CPF, MATRICULA, IMPOSTO)
VALUES ('001', TO_DATE('2019-01-01', 'YYYY-MM-DD'), '1471156710','235', 0.1 );

SELECT * FROM ITENS_NOTAS;

INSERT INTO ITENS_NOTAS (NUMERO, CODIGO, QUANTIDADE, PRECO)
VALUES ('001', '1040107', 10, 10 );

INSERT INTO NOTAS (NUMERO, DATA_VENDA, CPF, MATRICULA, IMPOSTO)
VALUES ('002', TO_DATE('2019-01-01','YYYY-MM-DD'), '1471156710', '235', 0.1);

INSERT INTO ITENS_NOTAS (NUMERO, CODIGO, QUANTIDADE, PRECO)
VALUES ('002', '100090', 15, 10);

INSERT INTO NOTAS (NUMERO, DATA_VENDA, CPF, MATRICULA, IMPOSTO)
VALUES ('003', TO_DATE('2019-01-03','YYYY-MM-DD'), '1471156710', '235', 0.1);

INSERT INTO ITENS_NOTAS (NUMERO, CODIGO, QUANTIDADE, PRECO)
VALUES ('003', '100092', 18, 10);

SELECT * FROM ITENS_NOTAS;


SELECT 
N.DATA_VENDA, SUM(ITN.QUANTIDADE * ITN.PRECO) AS FATURAMENTO
FROM
NOTAS N
INNER JOIN
ITENS_NOTAS ITN
ON N.NUMERO = ITN.NUMERO
GROUP BY N.DATA_VENDA;

CREATE TABLE TAB_FATURAMENTO
(
DATA_VENDA DATE NULL, FATURAMENTO FLOAT 
);

SELECT * FROM TAB_FATURAMENTO;

INSERT INTO TAB_FATURAMENTO 
SELECT 
N.DATA_VENDA, SUM(ITN.QUANTIDADE * ITN.PRECO) AS FATURAMENTO
FROM
NOTAS N
INNER JOIN
ITENS_NOTAS ITN
ON N.NUMERO = ITN.NUMERO
GROUP BY N.DATA_VENDA;

INSERT INTO NOTAS (NUMERO, DATA_VENDA, CPF, MATRICULA, IMPOSTO)
VALUES ('004', TO_DATE('2019-01-02','YYYY-MM-DD'), '1471156710', '235', 0.1);

INSERT INTO ITENS_NOTAS (NUMERO, CODIGO, QUANTIDADE, PRECO)
VALUES ('004', '100089', 21, 10);

DELETE FROM TAB_FATURAMENTO;






